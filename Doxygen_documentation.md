See #2600 and #2599